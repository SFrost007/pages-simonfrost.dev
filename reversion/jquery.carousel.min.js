/* jQuery Carousel 0.9.8
Copyright 2010 Thomas Lanciaux and Pierre Bertet.
Modified 2012 Simon Frost - support changing item sizes
This software is licensed under the CC-GNU LGPL <http://creativecommons.org/licenses/LGPL/2.1/>
*/
(function(a){function b(b){var c=b.$elts.content.children();var d=0;c.each(function(){$item=a(this);$itemHeight=$item.outerHeight();if($itemHeight>d){d=$itemHeight}});if(b.params.verticalMargin>0){d=d+b.params.verticalMargin}var e=b.$elts.content.children(":first");b.firstItem=e;j(b)}function c(b){b.$elts.nextBtn.add(b.$elts.prevBtn).bind("enable",function(){var c=a(this).unbind("click").bind("click",function(){if(b.params.ajaxMode&&c.is(".next")&&o(b)==n(b)-1&&!b.lastItemsToLoad){p(b);b.$elts.content.ajaxSuccess(function(){})}else{g(b,h(b,c.is(".next")?"next":"prev"));if(b.params.stopSlideBtn==true){b.$elts.stopSlideBtn.trigger("pause")}else{l(b)}}}).removeClass("disabled").removeAttr("disabled");if(b.params.combinedClasses){c.removeClass("next-disabled previous-disabled").removeAttr("disabled")}}).bind("disable",function(){var c=a(this).unbind("click").addClass("disabled").attr("disabled","disabled");if(b.params.combinedClasses){if(c.is(".next")){c.addClass("next-disabled")}else if(c.is(".previous")){c.addClass("previous-disabled")}}}).hover(function(){a(this).toggleClass("hover")})}function d(b){b.$elts.pagination=a('<div class="center-wrap"><div class="carousel-pagination"><p></p></div></div>')[b.params.paginationPosition=="outside"?"insertAfter":"appendTo"](b.$elts.carousel).find("p");b.$elts.paginationBtns=a([]);b.$elts.content.children().each(function(a){if(a%b.params.dispItems==0){e(b,a)}})}function e(b,c){if(b.params.pagination){b.$elts.paginationBtns=b.$elts.paginationBtns.add(a('<a role="button"><span>'+b.params.tabLabel(b.$elts.paginationBtns.length+1)+"</span></a>").data("firstStep",c)).appendTo(b.$elts.pagination);b.$elts.paginationBtns.slice(0,1).addClass("active");b.$elts.paginationBtns.click(function(c){g(b,a(this).data("firstStep"));if(b.params.stopSlideBtn==true){b.$elts.stopSlideBtn.trigger("pause")}else{l(b)}})}}function f(b){if(b.params.useAddress&&a.isFunction(a.fn.address)){a.address.init(function(c){var d=a.address.pathNames();if(d[0]===b.params.adressIdentifier&&!!d[1]){g(b,d[1]-1)}else{a.address.value("/"+b.params.adressIdentifier+"/1")}}).change(function(c){var d=a.address.pathNames();if(d[0]===b.params.adressIdentifier&&!!d[1]){g(b,d[1]-1)}})}else{b.params.useAddress=false}}function g(b,c){b.params.callback(c);i(b,c);b.steps.first=c;j(b);if(b.params.useAddress){a.address.value("/"+b.params.adressIdentifier+"/"+(c+1))}}function h(a,b){if(b=="prev"){if(!a.params.showEmptyItems){if(a.steps.first==0){return a.params.loop?a.steps.count-a.params.dispItems:false}else{return Math.max(0,a.steps.first-a.params.dispItems)}}else{if(a.steps.first-a.params.dispItems>=0){return a.steps.first-a.params.dispItems}else{return a.params.loop?a.steps.count-a.params.dispItems:false}}}else if(b=="next"){if(a.steps.first+a.params.dispItems<a.steps.count){if(!a.params.showEmptyItems){return Math.min(a.steps.first+a.params.dispItems,a.steps.count-a.params.dispItems)}else{return a.steps.first+a.params.dispItems}}else{return a.params.loop?0:false}}}function i(a,b){switch(a.params.effect){case"no":if(a.params.direction=="vertical"){a.$elts.content.css("top",-(a.itemHeight*b)+"px")}else{a.$elts.content.css("left",-(a.firstItem.outerWidth()*b)+"px")}break;case"fade":if(a.params.direction=="vertical"){a.$elts.content.hide().css("top",-(a.itemHeight*b)+"px").fadeIn(a.params.animSpeed)}else{a.$elts.content.hide().css("left",-(a.firstItem.outerWidth()*b)+"px").fadeIn(a.params.animSpeed)}break;default:if(a.params.direction=="vertical"){a.$elts.content.stop().animate({top:-(a.itemHeight*b)+"px"},a.params.animSpeed,a.params.slideEasing)}else{a.$elts.content.stop().animate({left:-(a.firstItem.outerWidth()*b)+"px"},a.params.animSpeed,a.params.slideEasing)}break}a.$elts.content.width(a.firstItem.outerWidth()*a.steps.count)}function j(b){if(h(b,"prev")!==false){b.$elts.prevBtn.trigger("enable")}else{b.$elts.prevBtn.trigger("disable")}if(h(b,"next")!==false){b.$elts.nextBtn.trigger("enable")}else{b.$elts.nextBtn.trigger("disable")}if(b.params.pagination){b.$elts.paginationBtns.removeClass("active").filter(function(){return a(this).data("firstStep")==b.steps.first}).addClass("active")}}function k(a){a.delayAutoSlide=window.setTimeout(function(){a.autoSlideInterval=window.setInterval(function(){g(a,h(a,"next"))},a.params.autoSlideInterval)},a.params.delayAutoSlide)}function l(a){window.clearTimeout(a.delayAutoSlide);window.clearInterval(a.autoSlideInterval);a.params.delayAutoSlide=0}function m(a){var b=a.$elts.stopSlideBtn;b.bind({play:function(){k(a);b.removeClass("pause").addClass("play").html(a.params.stopSlideTextPause)},pause:function(){l(a);b.removeClass("play").addClass("pause").html(a.params.stopSlideTextPlay)}});b.click(function(a){if(b.is(".play")){b.trigger("pause")}else if(b.is(".pause")){b.trigger("play")}});b.prependTo(a.$elts.wrap)}function n(a){return a.$elts.pagination.children().length}function o(a){return a.steps.first/a.params.dispItems}function p(c){c.$elts.carousel.prepend(c.$elts.loader);a.ajax({url:c.params.ajaxUrl,dataType:"json",success:function(d){c.lastItemsToLoad=d.bLastItemsToLoad;a(c.$elts.content).append(d.shtml);c.steps={first:c.steps.first+c.params.dispItems,count:c.$elts.content.children().length};c.steps.last=c.steps.count-1;b(c);e(c,c.steps.first);g(c,c.steps.first);if(c.params.stopSlideBtn==true){c.$elts.stopSlideBtn.trigger("pause")}else{l(c)}c.$elts.loader.remove()}})}a.fn.carousel=function(e){var e=a.extend({direction:"horizontal",loop:false,dispItems:1,pagination:false,paginationPosition:"inside",nextBtn:'<input type="button" value="Next" />',prevBtn:'<input type="button" value="Previous" />',btnsPosition:"inside",nextBtnInsert:"insertAfter",prevBtnInsert:"insertBefore",nextBtnInsertFn:false,prevBtnInsertFn:false,autoSlide:false,autoSlideInterval:3e3,delayAutoSlide:false,combinedClasses:false,effect:"slide",slideEasing:"swing",animSpeed:300,equalWidths:"true",verticalMargin:0,callback:function(){},useAddress:false,adressIdentifier:"carousel",tabLabel:function(a){return a},showEmptyItems:true,ajaxMode:false,ajaxUrl:"",stopSlideBtn:false,stopSlideTextPause:"Pause",stopSlideTextPlay:"Play"},e);if(e.btnsPosition=="outside"){e.prevBtnInsert="insertBefore";e.nextBtnInsert="insertAfter"}e.delayAutoSlide=0+e.delayAutoSlide;return this.each(function(){var g={$elts:{},params:e,launchOnLoad:[]};g.$elts.carousel=a(this).addClass("js");g.$elts.content=a(this).children().css({position:"absolute",top:0});g.$elts.wrap=g.$elts.content.wrap('<div class="carousel-wrap"></div>').parent().css({overflow:"hidden",position:"relative"});g.steps={first:0,count:g.$elts.content.children().length};g.$elts.loader=a('<div class="loader"></div>').css({position:"absolute"});g.steps.last=g.steps.count-1;if(g.params.pagination){d(g)}if(a.isFunction(g.params.prevBtnInsertFn)){g.$elts.prevBtn=g.params.prevBtnInsertFn(g.$elts)}else{if(e.btnsPosition=="outside"){g.$elts.prevBtn=a(e.prevBtn)[e.prevBtnInsert](g.$elts.carousel)}else{g.$elts.prevBtn=a(e.prevBtn)[e.prevBtnInsert](g.$elts.wrap)}}if(a.isFunction(g.params.nextBtnInsertFn)){g.$elts.nextBtn=g.params.nextBtnInsertFn(g.$elts)}else{if(e.btnsPosition=="outside"){g.$elts.nextBtn=a(e.nextBtn)[e.nextBtnInsert](g.$elts.carousel)}else{g.$elts.nextBtn=a(e.nextBtn)[e.nextBtnInsert](g.$elts.wrap)}}g.$elts.nextBtn.addClass("carousel-control next carousel-next");g.$elts.prevBtn.addClass("carousel-control previous carousel-previous");g.lastItemsToLoad;c(g);g.$elts.carousel.attr("tabindex",0).add(g.$elts.carousel.children()).bind({focus:function(b){a(document).bind("keypress",function(a){switch(a.keyCode){case 39:g.$elts.nextBtn.click();break;case 37:g.$elts.prevBtn.click();break}switch(a.charCode){case 110:g.$elts.nextBtn.click();break;case 112:g.$elts.prevBtn.click();break}})},blur:function(){a(document).unbind("keypress")}});f(g);a(function(){b(g);a.each(g.launchOnLoad,function(a,b){b()});if(g.params.autoSlide){k(g)}if(e.stopSlideBtn==true){g.$elts.stopSlideBtn=a('<button type="button" class="slide-control play">'+e.stopSlideTextPause+"</button>");m(g)}})})};})(jQuery);